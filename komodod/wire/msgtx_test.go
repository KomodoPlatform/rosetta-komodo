// Copyright (c) 2013-2016 The btcsuite developers
// Use of this source code is governed by an ISC
// license that can be found in the LICENSE file.

package wire

import (
	"bytes"
	"encoding/hex"
	"fmt"
	"io"
	"reflect"
	"testing"

	"github.com/davecgh/go-spew/spew"

	"github.com/DeckerSU/rosetta-komodo/komodod/chaincfg/chainhash"
)

// [decker] just for debug (de)serialisation features, etc.
func TestTransactions(t *testing.T) {
	msg := NewMsgTx(1)
	fmt.Printf("Size: %d\n", msg.SerializeSizeStripped())
	buf := bytes.NewBuffer(make([]byte, 0, msg.SerializeSizeStripped()))
	_ = msg.SerializeNoWitness(buf)

	for _, b := range buf.Bytes() {
		fmt.Printf("%02x ", b)
	}

	fmt.Println()

	fmt.Printf("%x\n", buf.Bytes())
}

// TestTx tests the MsgTx API.
func TestTx(t *testing.T) {
	pver := ProtocolVersion

	// Block 100000 hash.
	hashStr := "000000016845a9f945079aa52680def9eafd5ea39c86dfdb5ef5630d18e3e74f"
	hash, err := chainhash.NewHashFromStr(hashStr)
	if err != nil {
		t.Errorf("NewHashFromStr: %v", err)
	}

	// Ensure the command is expected value.
	wantCmd := "tx"
	msg := NewMsgTx(1)
	if cmd := msg.Command(); cmd != wantCmd {
		t.Errorf("NewMsgAddr: wrong command - got %v want %v",
			cmd, wantCmd)
	}

	// Ensure max payload is expected value for latest protocol version.
	wantPayload := uint32(1000 * 4000)
	maxPayload := msg.MaxPayloadLength(pver)
	if maxPayload != wantPayload {
		t.Errorf("MaxPayloadLength: wrong max payload length for "+
			"protocol version %d - got %v, want %v", pver,
			maxPayload, wantPayload)
	}

	// Ensure we get the same transaction output point data back out.
	// NOTE: This is a block hash and made up index, but we're only
	// testing package functionality.
	prevOutIndex := uint32(1)
	prevOut := NewOutPoint(hash, prevOutIndex)
	if !prevOut.Hash.IsEqual(hash) {
		t.Errorf("NewOutPoint: wrong hash - got %v, want %v",
			spew.Sprint(&prevOut.Hash), spew.Sprint(hash))
	}
	if prevOut.Index != prevOutIndex {
		t.Errorf("NewOutPoint: wrong index - got %v, want %v",
			prevOut.Index, prevOutIndex)
	}
	prevOutStr := fmt.Sprintf("%s:%d", hash.String(), prevOutIndex)
	if s := prevOut.String(); s != prevOutStr {
		t.Errorf("OutPoint.String: unexpected result - got %v, "+
			"want %v", s, prevOutStr)
	}

	// Ensure we get the same transaction input back out.
	sigScript := []byte{0x04, 0x31, 0xdc, 0x00, 0x1b, 0x01, 0x62}

	txIn := NewTxIn(prevOut, sigScript)
	if !reflect.DeepEqual(&txIn.PreviousOutPoint, prevOut) {
		t.Errorf("NewTxIn: wrong prev outpoint - got %v, want %v",
			spew.Sprint(&txIn.PreviousOutPoint),
			spew.Sprint(prevOut))
	}
	if !bytes.Equal(txIn.SignatureScript, sigScript) {
		t.Errorf("NewTxIn: wrong signature script - got %v, want %v",
			spew.Sdump(txIn.SignatureScript),
			spew.Sdump(sigScript))
	}

	// Ensure we get the same transaction output back out.
	txValue := int64(5000000000)
	pkScript := []byte{
		0x41, // OP_DATA_65
		0x04, 0xd6, 0x4b, 0xdf, 0xd0, 0x9e, 0xb1, 0xc5,
		0xfe, 0x29, 0x5a, 0xbd, 0xeb, 0x1d, 0xca, 0x42,
		0x81, 0xbe, 0x98, 0x8e, 0x2d, 0xa0, 0xb6, 0xc1,
		0xc6, 0xa5, 0x9d, 0xc2, 0x26, 0xc2, 0x86, 0x24,
		0xe1, 0x81, 0x75, 0xe8, 0x51, 0xc9, 0x6b, 0x97,
		0x3d, 0x81, 0xb0, 0x1c, 0xc3, 0x1f, 0x04, 0x78,
		0x34, 0xbc, 0x06, 0xd6, 0xd6, 0xed, 0xf6, 0x20,
		0xd1, 0x84, 0x24, 0x1a, 0x6a, 0xed, 0x8b, 0x63,
		0xa6, // 65-byte signature
		0xac, // OP_CHECKSIG
	}
	txOut := NewTxOut(txValue, pkScript)
	if txOut.Value != txValue {
		t.Errorf("NewTxOut: wrong pk script - got %v, want %v",
			txOut.Value, txValue)

	}
	if !bytes.Equal(txOut.PkScript, pkScript) {
		t.Errorf("NewTxOut: wrong pk script - got %v, want %v",
			spew.Sdump(txOut.PkScript),
			spew.Sdump(pkScript))
	}

	// Ensure transaction inputs are added properly.
	msg.AddTxIn(txIn)
	if !reflect.DeepEqual(msg.TxIn[0], txIn) {
		t.Errorf("AddTxIn: wrong transaction input added - got %v, want %v",
			spew.Sprint(msg.TxIn[0]), spew.Sprint(txIn))
	}

	// Ensure transaction outputs are added properly.
	msg.AddTxOut(txOut)
	if !reflect.DeepEqual(msg.TxOut[0], txOut) {
		t.Errorf("AddTxIn: wrong transaction output added - got %v, want %v",
			spew.Sprint(msg.TxOut[0]), spew.Sprint(txOut))
	}

	// Ensure the copy produced an identical transaction message.
	newMsg := msg.Copy()
	if !reflect.DeepEqual(newMsg, msg) {
		t.Errorf("Copy: mismatched tx messages - got %v, want %v",
			spew.Sdump(newMsg), spew.Sdump(msg))
	}
}

// TestTxHash tests the ability to generate the hash of a transaction accurately.
func TestTxHash(t *testing.T) {
	// Hash of first transaction from block 113875.
	hashStr := "c1d8974a0fbf004ad6999da3dbf39b94eb8e8cbaf0ee3aca790876525a618d19"
	wantHash, err := chainhash.NewHashFromStr(hashStr)
	if err != nil {
		t.Errorf("NewHashFromStr: %v", err)
		return
	}

	// First transaction from block 113875.
	msgTx := NewMsgTx(1)
	txIn := TxIn{
		PreviousOutPoint: OutPoint{
			Hash:  chainhash.Hash{},
			Index: 0xffffffff,
		},
		SignatureScript: []byte{0x03, 0xd3, 0xbc, 0x01, 0x00, 0x5a, 0x2d, 0x4e, 0x4f, 0x4d, 0x50, 0x21, 0x20, 0x68, 0x74, 0x74, 0x70, 0x73, 0x3a, 0x2f, 0x2f, 0x67, 0x69, 0x74, 0x68, 0x75, 0x62, 0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x6a, 0x6f, 0x73, 0x68, 0x75, 0x61, 0x79, 0x61, 0x62, 0x75, 0x74, 0x2f, 0x7a, 0x2d, 0x6e, 0x6f, 0x6d, 0x70},
		Sequence:        0xffffffff,
	}
	txOut := TxOut{
		Value: 1143750000,
		PkScript: []byte{
			0x76, 0xa9, 0x14, 0x8e, 0x03, 0x7e, 0xaf, 0x85, 0x68, 0x18, 0x1b, 0x46, 0x00, 0x83, 0x4b, 0x6a, 0x8d, 0xf4, 0xe1, 0xae, 0x04, 0x92, 0xbf, 0x88, 0xac,
		},
	}
	txOut2 := TxOut{
		Value: 106250000,
		PkScript: []byte{
			0xa9, 0x14, 0x50, 0x29, 0x50, 0x8c, 0xb3, 0xc3, 0x1c, 0xc2, 0x06, 0x58, 0x9e, 0x37, 0x34, 0xaa, 0x53, 0x90, 0xf9, 0xac, 0x4c, 0x7e, 0x87,
		},
	}
	msgTx.AddTxIn(&txIn)
	msgTx.AddTxOut(&txOut)
	msgTx.AddTxOut(&txOut2)
	msgTx.LockTime = 0

	// Ensure the hash produced is expected.
	txHash := msgTx.TxHash()
	if !txHash.IsEqual(wantHash) {
		t.Errorf("TxHash: wrong hash - got %v, want %v",
			spew.Sprint(txHash), spew.Sprint(wantHash))
	}
}

// TestTxWire tests the MsgTx wire encode and decode for various numbers
// of transaction inputs and outputs and protocol versions.
func TestTxWire(t *testing.T) {
	// Empty tx message.
	noTx := NewMsgTx(1)
	noTx.Version = 1
	noTxEncoded := []byte{
		0x01, 0x00, 0x00, 0x00, // Version
		0x00,                   // Varint for number of input transactions
		0x00,                   // Varint for number of output transactions
		0x00, 0x00, 0x00, 0x00, // Lock time
	}

	tests := []struct {
		in   *MsgTx          // Message to encode
		out  *MsgTx          // Expected decoded message
		buf  []byte          // Wire encoding
		pver uint32          // Protocol version for wire encoding
		enc  MessageEncoding // Message encoding format
	}{
		// Latest protocol version with no transactions.
		{
			noTx,
			noTx, noTxEncoded,
			ProtocolVersion,
			BaseEncoding,
		},

		// Latest protocol version with multiple transactions.
		{
			multiTx,
			multiTx,
			multiTxEncoded,
			ProtocolVersion,
			BaseEncoding,
		},

		// Protocol version BIP0035Version with no transactions.
		{
			noTx,
			noTx,
			noTxEncoded,
			BIP0035Version,
			BaseEncoding,
		},

		// Protocol version BIP0035Version with multiple transactions.
		{
			multiTx,
			multiTx,
			multiTxEncoded,
			BIP0035Version,
			BaseEncoding,
		},

		// Protocol version BIP0031Version with no transactions.
		{
			noTx,
			noTx,
			noTxEncoded,
			BIP0031Version,
			BaseEncoding,
		},

		// Protocol version BIP0031Version with multiple transactions.
		{
			multiTx,
			multiTx,
			multiTxEncoded,
			BIP0031Version,
			BaseEncoding,
		},

		// Protocol version NetAddressTimeVersion with no transactions.
		{
			noTx,
			noTx,
			noTxEncoded,
			NetAddressTimeVersion,
			BaseEncoding,
		},

		// Protocol version NetAddressTimeVersion with multiple transactions.
		{
			multiTx,
			multiTx,
			multiTxEncoded,
			NetAddressTimeVersion,
			BaseEncoding,
		},

		// Protocol version MultipleAddressVersion with no transactions.
		{
			noTx,
			noTx,
			noTxEncoded,
			MultipleAddressVersion,
			BaseEncoding,
		},

		// Protocol version MultipleAddressVersion with multiple transactions.
		{
			multiTx,
			multiTx,
			multiTxEncoded,
			MultipleAddressVersion,
			BaseEncoding,
		},
	}

	t.Logf("Running %d tests", len(tests))
	for i, test := range tests {
		// Encode the message to wire format.
		var buf bytes.Buffer
		err := test.in.BtcEncode(&buf, test.pver, test.enc)
		if err != nil {
			t.Errorf("BtcEncode #%d error %v", i, err)
			continue
		}
		if !bytes.Equal(buf.Bytes(), test.buf) {
			t.Errorf("BtcEncode #%d\n got: %s want: %s", i,
				spew.Sdump(buf.Bytes()), spew.Sdump(test.buf))
			continue
		}

		// Decode the message from wire format.
		var msg MsgTx
		rbuf := bytes.NewReader(test.buf)
		err = msg.BtcDecode(rbuf, test.pver, test.enc)
		if err != nil {
			t.Errorf("BtcDecode #%d error %v", i, err)
			continue
		}
		if !reflect.DeepEqual(&msg, test.out) {
			t.Errorf("BtcDecode #%d\n got: %s want: %s", i,
				spew.Sdump(&msg), spew.Sdump(test.out))
			continue
		}
	}
}

// TestTxWireErrors performs negative tests against wire encode and decode
// of MsgTx to confirm error paths work correctly.
func TestTxWireErrors(t *testing.T) {
	// Use protocol version 60002 specifically here instead of the latest
	// because the test data is using bytes encoded with that protocol
	// version.
	pver := uint32(60002)

	tests := []struct {
		in       *MsgTx          // Value to encode
		buf      []byte          // Wire encoding
		pver     uint32          // Protocol version for wire encoding
		enc      MessageEncoding // Message encoding format
		max      int             // Max size of fixed buffer to induce errors
		writeErr error           // Expected write error
		readErr  error           // Expected read error
	}{
		// Force error in version.
		{multiTx, multiTxEncoded, pver, BaseEncoding, 0, io.ErrShortWrite, io.EOF},
		// Force error in number of transaction inputs.
		{multiTx, multiTxEncoded, pver, BaseEncoding, 4, io.ErrShortWrite, io.EOF},
		// Force error in transaction input previous block hash.
		{multiTx, multiTxEncoded, pver, BaseEncoding, 5, io.ErrShortWrite, io.EOF},
		// Force error in transaction input previous block output index.
		{multiTx, multiTxEncoded, pver, BaseEncoding, 37, io.ErrShortWrite, io.EOF},
		// Force error in transaction input signature script length.
		{multiTx, multiTxEncoded, pver, BaseEncoding, 41, io.ErrShortWrite, io.EOF},
		// Force error in transaction input signature script.
		{multiTx, multiTxEncoded, pver, BaseEncoding, 42, io.ErrShortWrite, io.EOF},
		// Force error in transaction input sequence.
		{multiTx, multiTxEncoded, pver, BaseEncoding, 49, io.ErrShortWrite, io.ErrUnexpectedEOF},
		// Force error in number of transaction outputs.
		{multiTx, multiTxEncoded, pver, BaseEncoding, 53, io.ErrShortWrite, io.ErrUnexpectedEOF},
		// Force error in transaction output value.
		{multiTx, multiTxEncoded, pver, BaseEncoding, 54, io.ErrShortWrite, io.ErrUnexpectedEOF},
		// Force error in transaction output pk script length.
		{multiTx, multiTxEncoded, pver, BaseEncoding, 62, io.ErrShortWrite, io.ErrUnexpectedEOF},
		// Force error in transaction output pk script.
		{multiTx, multiTxEncoded, pver, BaseEncoding, 63, io.ErrShortWrite, io.ErrUnexpectedEOF},
	}

	t.Logf("Running %d tests", len(tests))
	for i, test := range tests {
		// Encode to wire format.
		w := newFixedWriter(test.max)
		err := test.in.BtcEncode(w, test.pver, test.enc)
		if err != test.writeErr {
			t.Errorf("BtcEncode #%d wrong error got: %v, want: %v",
				i, err, test.writeErr)
			continue
		}

		// Decode from wire format.
		var msg MsgTx
		r := newFixedReader(test.max, test.buf)
		err = msg.BtcDecode(r, test.pver, test.enc)
		if err != test.readErr {
			t.Errorf("BtcDecode #%d wrong error got: %v, want: %v",
				i, err, test.readErr)
			continue
		}
	}
}

// TestTxSerialize tests MsgTx serialize and deserialize.
func TestTxSerialize(t *testing.T) {
	noTx := NewMsgTx(1)
	noTx.Version = 1
	noTxEncoded := []byte{
		0x01, 0x00, 0x00, 0x00, // Version
		0x00,                   // Varint for number of input transactions
		0x00,                   // Varint for number of output transactions
		0x00, 0x00, 0x00, 0x00, // Lock time
	}

	tests := []struct {
		in           *MsgTx // Message to encode
		out          *MsgTx // Expected decoded message
		buf          []byte // Serialized data
		pkScriptLocs []int  // Expected output script locations
		witness      bool   // Serialize using the witness encoding
	}{
		// No transactions.
		{
			noTx,
			noTx,
			noTxEncoded,
			nil,
			false,
		},

		// Multiple transactions.
		{
			multiTx,
			multiTx,
			multiTxEncoded,
			multiTxPkScriptLocs,
			false,
		},
	}

	t.Logf("Running %d tests", len(tests))
	for i, test := range tests {
		// Serialize the transaction.
		var buf bytes.Buffer
		err := test.in.Serialize(&buf)
		if err != nil {
			t.Errorf("Serialize #%d error %v", i, err)
			continue
		}
		if !bytes.Equal(buf.Bytes(), test.buf) {
			t.Errorf("Serialize #%d\n got: %s want: %s", i,
				spew.Sdump(buf.Bytes()), spew.Sdump(test.buf))
			continue
		}

		// Deserialize the transaction.
		var tx MsgTx
		rbuf := bytes.NewReader(test.buf)
		if test.witness {
			err = tx.Deserialize(rbuf)
		} else {
			err = tx.DeserializeNoWitness(rbuf)
		}
		if err != nil {
			t.Errorf("Deserialize #%d error %v", i, err)
			continue
		}
		if !reflect.DeepEqual(&tx, test.out) {
			t.Errorf("Deserialize #%d\n got: %s want: %s", i,
				spew.Sdump(&tx), spew.Sdump(test.out))
			continue
		}

		// Ensure the public key script locations are accurate.
		pkScriptLocs := test.in.PkScriptLocs()
		if !reflect.DeepEqual(pkScriptLocs, test.pkScriptLocs) {
			t.Errorf("PkScriptLocs #%d\n got: %s want: %s", i,
				spew.Sdump(pkScriptLocs),
				spew.Sdump(test.pkScriptLocs))
			continue
		}
		for j, loc := range pkScriptLocs {
			wantPkScript := test.in.TxOut[j].PkScript
			gotPkScript := test.buf[loc : loc+len(wantPkScript)]
			if !bytes.Equal(gotPkScript, wantPkScript) {
				t.Errorf("PkScriptLocs #%d:%d\n unexpected "+
					"script got: %s want: %s", i, j,
					spew.Sdump(gotPkScript),
					spew.Sdump(wantPkScript))
			}
		}
	}
}

// TestTxSerializeErrors performs negative tests against wire encode and decode
// of MsgTx to confirm error paths work correctly.
func TestTxSerializeErrors(t *testing.T) {
	tests := []struct {
		in       *MsgTx // Value to encode
		buf      []byte // Serialized data
		max      int    // Max size of fixed buffer to induce errors
		writeErr error  // Expected write error
		readErr  error  // Expected read error
	}{
		// Force error in version.
		{multiTx, multiTxEncoded, 0, io.ErrShortWrite, io.EOF},
		// Force error in number of transaction inputs.
		{multiTx, multiTxEncoded, 4, io.ErrShortWrite, io.EOF},
		// Force error in transaction input previous block hash.
		{multiTx, multiTxEncoded, 5, io.ErrShortWrite, io.EOF},
		// Force error in transaction input previous block output index.
		{multiTx, multiTxEncoded, 37, io.ErrShortWrite, io.EOF},
		// Force error in transaction input signature script length.
		{multiTx, multiTxEncoded, 41, io.ErrShortWrite, io.EOF},
		// Force error in transaction input signature script.
		{multiTx, multiTxEncoded, 42, io.ErrShortWrite, io.EOF},
		// Force error in transaction input sequence.
		{multiTx, multiTxEncoded, 49, io.ErrShortWrite, io.ErrUnexpectedEOF},
		// Force error in number of transaction outputs.
		{multiTx, multiTxEncoded, 53, io.ErrShortWrite, io.ErrUnexpectedEOF},
		// Force error in transaction output value.
		{multiTx, multiTxEncoded, 54, io.ErrShortWrite, io.ErrUnexpectedEOF},
		// Force error in transaction output pk script length.
		{multiTx, multiTxEncoded, 62, io.ErrShortWrite, io.ErrUnexpectedEOF},
		// Force error in transaction output pk script.
		{multiTx, multiTxEncoded, 63, io.ErrShortWrite, io.ErrUnexpectedEOF},
	}

	t.Logf("Running %d tests", len(tests))
	for i, test := range tests {
		// Serialize the transaction.
		w := newFixedWriter(test.max)
		err := test.in.Serialize(w)
		if err != test.writeErr {
			t.Errorf("Serialize #%d wrong error got: %v, want: %v",
				i, err, test.writeErr)
			continue
		}

		// Deserialize the transaction.
		var tx MsgTx
		r := newFixedReader(test.max, test.buf)
		err = tx.Deserialize(r)
		if err != test.readErr {
			t.Errorf("Deserialize #%d wrong error got: %v, want: %v",
				i, err, test.readErr)
			continue
		}
	}
}

// TestTxOverflowErrors performs tests to ensure deserializing transactions
// which are intentionally crafted to use large values for the variable number
// of inputs and outputs are handled properly.  This could otherwise potentially
// be used as an attack vector.
func TestTxOverflowErrors(t *testing.T) {
	// Use protocol version 70001 and transaction version 1 specifically
	// here instead of the latest values because the test data is using
	// bytes encoded with those versions.
	pver := uint32(70001)
	txVer := uint32(1)

	tests := []struct {
		buf     []byte          // Wire encoding
		pver    uint32          // Protocol version for wire encoding
		enc     MessageEncoding // Message encoding format
		version uint32          // Transaction version
		err     error           // Expected error
	}{
		// Transaction that claims to have ~uint64(0) inputs.
		{
			[]byte{
				0x00, 0x00, 0x00, 0x01, // Version
				0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
				0xff, // Varint for number of input transactions
			}, pver, BaseEncoding, txVer, &MessageError{},
		},

		// Transaction that claims to have ~uint64(0) outputs.
		{
			[]byte{
				0x00, 0x00, 0x00, 0x01, // Version
				0x00, // Varint for number of input transactions
				0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
				0xff, // Varint for number of output transactions
			}, pver, BaseEncoding, txVer, &MessageError{},
		},

		// Transaction that has an input with a signature script that
		// claims to have ~uint64(0) length.
		{
			[]byte{
				0x00, 0x00, 0x00, 0x01, // Version
				0x01, // Varint for number of input transactions
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // Previous output hash
				0xff, 0xff, 0xff, 0xff, // Prevous output index
				0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
				0xff, // Varint for length of signature script
			}, pver, BaseEncoding, txVer, &MessageError{},
		},

		// Transaction that has an output with a public key script
		// that claims to have ~uint64(0) length.
		{
			[]byte{
				0x00, 0x00, 0x00, 0x01, // Version
				0x01, // Varint for number of input transactions
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // Previous output hash
				0xff, 0xff, 0xff, 0xff, // Prevous output index
				0x00,                   // Varint for length of signature script
				0xff, 0xff, 0xff, 0xff, // Sequence
				0x01,                                           // Varint for number of output transactions
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // Transaction amount
				0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
				0xff, // Varint for length of public key script
			}, pver, BaseEncoding, txVer, &MessageError{},
		},
	}

	t.Logf("Running %d tests", len(tests))
	for i, test := range tests {
		// Decode from wire format.
		var msg MsgTx
		r := bytes.NewReader(test.buf)
		err := msg.BtcDecode(r, test.pver, test.enc)
		if reflect.TypeOf(err) != reflect.TypeOf(test.err) {
			t.Errorf("BtcDecode #%d wrong error got: %v, want: %v",
				i, err, reflect.TypeOf(test.err))
			continue
		}

		// Decode from wire format.
		r = bytes.NewReader(test.buf)
		err = msg.Deserialize(r)
		if reflect.TypeOf(err) != reflect.TypeOf(test.err) {
			t.Errorf("Deserialize #%d wrong error got: %v, want: %v",
				i, err, reflect.TypeOf(test.err))
			continue
		}
	}
}

// TestTxSerializeSizeStripped performs tests to ensure the serialize size for
// various transactions is accurate.
func TestTxSerializeSizeStripped(t *testing.T) {
	// Empty tx message.
	noTx := NewMsgTx(1)
	noTx.Version = 1

	tests := []struct {
		in   *MsgTx // Tx to encode
		size int    // Expected serialized size
	}{
		// No inputs or outpus.
		{noTx, 10},

		// Transcaction with an input and an output.
		{multiTx, 167},
	}

	t.Logf("Running %d tests", len(tests))
	for i, test := range tests {
		serializedSize := test.in.SerializeSizeStripped()
		if serializedSize != test.size {
			t.Errorf("MsgTx.SerializeSizeStripped: #%d got: %d, want: %d", i,
				serializedSize, test.size)
			continue
		}
	}
}

func TestDeserializedShieldedTx(t *testing.T) {
	// Decode the message from wire format.
	var msg MsgTx
	rbuf := bytes.NewReader(shieldedTxEncoded)
	err := msg.BtcDecode(rbuf, ProtocolVersion, BaseEncoding)
	if err != nil {
		t.Errorf("BtcDecode error in shielded transaction %v", err)
	}

	hash, _ := chainhash.NewHashFromStr("9598acc6931c5f95a6934db6375e6f881b073a743b5a9c1d062eb3837d7e4b23")
	shieldedTx.TxIn[0].PreviousOutPoint.Hash = *hash

	// Serialize the transaction.
	var buf bytes.Buffer
	err = shieldedTx.Serialize(&buf)
	if !bytes.Equal(shieldedTxEncoded, buf.Bytes()) {
		t.Errorf("ShieldedTx serialized is different from the encoded one!"+
			"deserialized got: %s want: %s",
			spew.Sdump(hex.EncodeToString(buf.Bytes())),
			spew.Sdump(hex.EncodeToString(shieldedTxEncoded)))
	}
}

// multiTx is a MsgTx with an input and output and used in various tests.
var multiTx = &MsgTx{
	Version: 1,
	TxIn: []*TxIn{
		{
			PreviousOutPoint: OutPoint{
				Hash:  chainhash.Hash{},
				Index: 0xffffffff,
			},
			SignatureScript: []byte{0x03, 0xd3, 0xbc, 0x01, 0x00, 0x5a, 0x2d, 0x4e, 0x4f, 0x4d, 0x50, 0x21, 0x20, 0x68, 0x74, 0x74, 0x70, 0x73, 0x3a, 0x2f, 0x2f, 0x67, 0x69, 0x74, 0x68, 0x75, 0x62, 0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x6a, 0x6f, 0x73, 0x68, 0x75, 0x61, 0x79, 0x61, 0x62, 0x75, 0x74, 0x2f, 0x7a, 0x2d, 0x6e, 0x6f, 0x6d, 0x70},
			Sequence:        0xffffffff,
		},
	},
	TxOut: []*TxOut{
		{
			Value: 1143750000,
			PkScript: []byte{
				0x76, 0xa9, 0x14, 0x8e, 0x03, 0x7e, 0xaf, 0x85, 0x68, 0x18, 0x1b, 0x46, 0x00, 0x83, 0x4b, 0x6a, 0x8d, 0xf4, 0xe1, 0xae, 0x04, 0x92, 0xbf, 0x88, 0xac,
			},
		},
		{
			Value: 106250000,
			PkScript: []byte{
				0xa9, 0x14, 0x50, 0x29, 0x50, 0x8c, 0xb3, 0xc3, 0x1c, 0xc2, 0x06, 0x58, 0x9e, 0x37, 0x34, 0xaa, 0x53, 0x90, 0xf9, 0xac, 0x4c, 0x7e, 0x87,
			},
		},
	},
	LockTime: 0,
}

// multiTxEncoded is the wire encoded bytes for multiTx using protocol version
// 60002 and is used in the various tests.
var multiTxEncoded = []byte{
	0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0x32, 0x03, 0xd3, 0xbc, 0x01, 0x00, 0x5a, 0x2d, 0x4e, 0x4f, 0x4d, 0x50, 0x21, 0x20, 0x68, 0x74, 0x74, 0x70, 0x73, 0x3a, 0x2f, 0x2f, 0x67, 0x69, 0x74, 0x68, 0x75, 0x62, 0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x6a, 0x6f, 0x73, 0x68, 0x75, 0x61, 0x79, 0x61, 0x62, 0x75, 0x74, 0x2f, 0x7a, 0x2d, 0x6e, 0x6f, 0x6d, 0x70, 0xff, 0xff, 0xff, 0xff, 0x02, 0x70, 0x3d, 0x2c, 0x44, 0x00, 0x00, 0x00, 0x00, 0x19, 0x76, 0xa9, 0x14, 0x8e, 0x03, 0x7e, 0xaf, 0x85, 0x68, 0x18, 0x1b, 0x46, 0x00, 0x83, 0x4b, 0x6a, 0x8d, 0xf4, 0xe1, 0xae, 0x04, 0x92, 0xbf, 0x88, 0xac, 0x10, 0x3f, 0x55, 0x06, 0x00, 0x00, 0x00, 0x00, 0x17, 0xa9, 0x14, 0x50, 0x29, 0x50, 0x8c, 0xb3, 0xc3, 0x1c, 0xc2, 0x06, 0x58, 0x9e, 0x37, 0x34, 0xaa, 0x53, 0x90, 0xf9, 0xac, 0x4c, 0x7e, 0x87, 0x00, 0x00, 0x00, 0x00,
}

// multiTxPkScriptLocs is the location information for the public key scripts
// located in multiTx.
var multiTxPkScriptLocs = []int{106, 140}

var shieldedTxEncoded = []byte{
	0x02, 0x00, 0x00, 0x00, 0x01, 0x23, 0x4b, 0x7e, 0x7d, 0x83, 0xb3, 0x2e, 0x06, 0x1d, 0x9c, 0x5a, 0x3b, 0x74, 0x3a, 0x07, 0x1b, 0x88, 0x6f, 0x5e, 0x37, 0xb6, 0x4d, 0x93, 0xa6, 0x95, 0x5f, 0x1c, 0x93, 0xc6, 0xac, 0x98, 0x95, 0x00, 0x00, 0x00, 0x00, 0x6a, 0x47, 0x30, 0x44, 0x02, 0x20, 0x11, 0x95, 0x12, 0x3c, 0x9a, 0xb5, 0xb7, 0xeb, 0xb0, 0x14, 0x11, 0xd5, 0x88, 0x37, 0xcf, 0x29, 0xa2, 0x7c, 0x6b, 0xaf, 0x2a, 0x8d, 0x50, 0x61, 0x63, 0x87, 0xaa, 0x5d, 0xae, 0x43, 0x50, 0x37, 0x02, 0x20, 0x60, 0xff, 0xa7, 0x5a, 0x73, 0x2f, 0x6f, 0x6d, 0x53, 0x74, 0x6b, 0x3a, 0x03, 0xa2, 0x90, 0x12, 0x12, 0x90, 0x7c, 0x8c, 0xd3, 0x3b, 0x29, 0x93, 0x8e, 0x2d, 0xed, 0xa4, 0xaa, 0xa4, 0x87, 0xb7, 0x01, 0x21, 0x03, 0xf8, 0x92, 0xec, 0x10, 0x6c, 0x94, 0xbd, 0xea, 0xd9, 0xf0, 0x88, 0x79, 0x7e, 0xc2, 0xbb, 0x6d, 0x0f, 0x46, 0xcc, 0x7f, 0x7e, 0x6a, 0x93, 0x1a, 0x0f, 0xd7, 0x6c, 0x52, 0xae, 0xe5, 0xd0, 0x16, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x60, 0x16, 0x2c, 0x44, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x6c, 0x18, 0x86, 0xca, 0x09, 0x33, 0xca, 0x62, 0x37, 0x04, 0xf4, 0x21, 0xe8, 0xa1, 0xd1, 0x88, 0x22, 0x52, 0x56, 0x72, 0x3c, 0x59, 0xca, 0xda, 0x5e, 0xf2, 0x40, 0x4d, 0x30, 0x3f, 0xd8, 0xea, 0x0e, 0x2f, 0x40, 0xc1, 0xa3, 0x6b, 0x58, 0x4e, 0x41, 0x36, 0x51, 0x03, 0xfa, 0xd6, 0x84, 0x73, 0x3b, 0x4f, 0xa3, 0x1f, 0x12, 0x5c, 0x58, 0xc7, 0x9e, 0x07, 0xf8, 0xdc, 0x89, 0x6b, 0x22, 0xb8, 0xb9, 0x38, 0xe0, 0xb1, 0xc5, 0x40, 0x31, 0xfe, 0x73, 0x9d, 0xbe, 0x7f, 0x90, 0x8b, 0x91, 0x29, 0x33, 0x64, 0x6d, 0x43, 0x0a, 0xa8, 0xf1, 0x18, 0xe3, 0x20, 0x1a, 0xb6, 0x35, 0xf5, 0xe4, 0xcd, 0xbd, 0x13, 0x90, 0x28, 0xda, 0x1d, 0x3a, 0x26, 0x2a, 0xc7, 0x35, 0xf5, 0xdb, 0x96, 0x6d, 0x39, 0x5b, 0xf1, 0x54, 0x81, 0x9a, 0x55, 0x2d, 0x5f, 0x5c, 0x91, 0x48, 0xdf, 0xcb, 0x5d, 0x19, 0x23, 0xbc, 0xc0, 0xdf, 0x6d, 0x5c, 0x33, 0xda, 0x5e, 0x4d, 0x0c, 0x86, 0x5f, 0x8a, 0xeb, 0xac, 0xbf, 0x86, 0xfd, 0x76, 0xc7, 0xf0, 0x27, 0x04, 0x3c, 0x15, 0x8e, 0xf7, 0xca, 0x04, 0x54, 0x7f, 0x6d, 0xd3, 0x01, 0xa9, 0xb3, 0x63, 0x1a, 0x78, 0x61, 0x4a, 0x80, 0x70, 0x8b, 0x63, 0x84, 0x3c, 0x2b, 0x79, 0x8b, 0x72, 0xe5, 0x02, 0x81, 0x19, 0xdb, 0xe4, 0xf7, 0xa9, 0x31, 0xf9, 0x26, 0xba, 0x58, 0x57, 0xab, 0xe8, 0xb0, 0x03, 0xb7, 0x8a, 0xe7, 0x15, 0x60, 0xbd, 0xdc, 0x63, 0xfa, 0x4b, 0x3a, 0xb2, 0xae, 0xfa, 0x32, 0x8f, 0xbf, 0x87, 0x46, 0x47, 0xad, 0x7a, 0x4b, 0x64, 0xa8, 0x90, 0xa0, 0x5c, 0xf3, 0x1a, 0x05, 0x02, 0x5b, 0x7a, 0x40, 0xca, 0xd1, 0x5e, 0xb3, 0xac, 0x69, 0x70, 0xc6, 0xd1, 0xf9, 0xce, 0x3f, 0xab, 0x59, 0x84, 0x77, 0x2b, 0x08, 0x1a, 0x48, 0xc1, 0x0a, 0xe4, 0x51, 0xbe, 0x6c, 0x10, 0x1a, 0x08, 0x7d, 0xce, 0x8b, 0xe2, 0x7e, 0xa6, 0x61, 0x05, 0xd2, 0xa7, 0x29, 0x6a, 0x9d, 0x7b, 0xba, 0x6a, 0x2a, 0xe2, 0x07, 0x5f, 0xee, 0x20, 0xe6, 0xc1, 0x78, 0xdf, 0x17, 0x02, 0x27, 0x8a, 0xa7, 0xb8, 0x6d, 0x41, 0x09, 0xac, 0xda, 0x64, 0x01, 0x65, 0x48, 0xfc, 0x23, 0x8d, 0x60, 0x52, 0x52, 0x30, 0x29, 0xc2, 0x85, 0xc1, 0x7e, 0x0c, 0xc4, 0x7b, 0xb1, 0x06, 0x49, 0xaa, 0x03, 0x02, 0x45, 0x79, 0x33, 0xdd, 0xea, 0x07, 0x92, 0xa1, 0xee, 0x27, 0x92, 0x0d, 0xda, 0xfb, 0x8a, 0x59, 0xe6, 0x54, 0x00, 0xd7, 0xef, 0x2b, 0x38, 0xad, 0x9a, 0x2d, 0x29, 0x2b, 0xc7, 0xb8, 0xca, 0x0b, 0x01, 0xbb, 0x79, 0xb2, 0x56, 0x46, 0xa5, 0x43, 0x69, 0xfd, 0x76, 0xa0, 0x3a, 0xc1, 0x8c, 0x9a, 0xbd, 0x42, 0xa6, 0x2c, 0xf4, 0xe2, 0x19, 0x8b, 0x9a, 0x7e, 0xab, 0xbe, 0x33, 0xa7, 0x3d, 0xc7, 0x4b, 0x0c, 0x0c, 0x3b, 0x24, 0x39, 0x5b, 0x72, 0xd2, 0x80, 0xdd, 0x08, 0x5e, 0xd8, 0x5c, 0x09, 0xa1, 0xe1, 0x01, 0x67, 0x93, 0x15, 0x36, 0xe0, 0x7b, 0x3a, 0x3c, 0xe6, 0xe1, 0x40, 0x00, 0xc6, 0x02, 0x2b, 0x03, 0xf9, 0x19, 0xee, 0xf0, 0x22, 0xdd, 0xe2, 0x9b, 0xf3, 0x3c, 0x82, 0x21, 0x78, 0x24, 0xd4, 0xfb, 0xfa, 0x01, 0x1c, 0x9d, 0xc4, 0xe7, 0x0c, 0x5a, 0xe9, 0x5a, 0xce, 0x32, 0x00, 0xd6, 0x02, 0x05, 0x0f, 0x8c, 0x46, 0x3e, 0x16, 0xa9, 0x45, 0x33, 0x6d, 0x4b, 0x82, 0xac, 0x44, 0x1b, 0x27, 0xe1, 0x69, 0x8c, 0x75, 0xb3, 0x96, 0x17, 0xa4, 0x2e, 0xb6, 0xad, 0xf1, 0x77, 0xfa, 0x6a, 0x63, 0x02, 0x1b, 0x8e, 0x15, 0x76, 0xfa, 0x2e, 0x7f, 0xc9, 0xa5, 0x50, 0x1b, 0x45, 0x3b, 0xde, 0x19, 0xaa, 0x53, 0xac, 0x40, 0xd7, 0xb5, 0x3f, 0x1a, 0xa7, 0xa4, 0x45, 0xaa, 0x06, 0x83, 0xce, 0xc1, 0xd5, 0x02, 0x2e, 0x03, 0x16, 0x4b, 0xcc, 0x99, 0x20, 0x12, 0x17, 0xb9, 0x42, 0x8b, 0xe3, 0x26, 0x36, 0x8b, 0x21, 0x07, 0xf8, 0x7e, 0xcd, 0xa2, 0x5f, 0xec, 0xab, 0x34, 0xfc, 0x7e, 0x4a, 0xce, 0x6e, 0xd7, 0x02, 0x10, 0xbd, 0xcc, 0xe9, 0x22, 0x54, 0x87, 0x9c, 0x34, 0x99, 0x7b, 0x01, 0x20, 0xf2, 0xb0, 0x20, 0xf5, 0xdd, 0x9d, 0x70, 0x25, 0x4e, 0xf1, 0x03, 0x7f, 0xd3, 0x02, 0x85, 0x26, 0x08, 0xf1, 0x43, 0x28, 0xf5, 0x43, 0x08, 0x63, 0x89, 0x89, 0x5c, 0x22, 0x96, 0x5d, 0x69, 0x7a, 0xf3, 0xe7, 0x2c, 0x58, 0x1b, 0x47, 0x1e, 0xed, 0x75, 0x4a, 0xc8, 0xd1, 0x5c, 0xfd, 0xa2, 0xdf, 0x8f, 0xb2, 0x98, 0x45, 0x1c, 0x1d, 0xe2, 0xf2, 0xf4, 0x99, 0xc6, 0x4a, 0xe4, 0xae, 0x70, 0x0f, 0xe4, 0x56, 0x57, 0x1e, 0xc5, 0xbc, 0x7b, 0x4b, 0x8b, 0xba, 0x19, 0x09, 0xd3, 0xe9, 0xfb, 0x17, 0x83, 0xec, 0x48, 0x67, 0xbb, 0x72, 0x36, 0x58, 0x4b, 0x6c, 0x86, 0xea, 0xd4, 0xcb, 0xb0, 0xc3, 0xaa, 0x22, 0xb2, 0xcf, 0xf9, 0x9a, 0xc7, 0x5c, 0x42, 0x2e, 0xf8, 0xf2, 0x14, 0x4e, 0x5b, 0x72, 0x32, 0x0b, 0x4c, 0x51, 0x41, 0x0b, 0x05, 0xea, 0xd6, 0x48, 0x22, 0x12, 0x42, 0xd3, 0xdf, 0xfc, 0x5c, 0xa5, 0xf9, 0x15, 0x58, 0x47, 0x14, 0x32, 0xf4, 0xeb, 0xbc, 0x28, 0x88, 0xe5, 0xd4, 0xc8, 0x1b, 0xae, 0x0f, 0x3e, 0x07, 0xd3, 0x71, 0xae, 0x56, 0x05, 0xd6, 0xbd, 0x19, 0x3a, 0x72, 0xfc, 0x91, 0x92, 0x52, 0x57, 0x51, 0x78, 0xd4, 0x1b, 0x48, 0xcb, 0x87, 0xad, 0xbf, 0xe6, 0x3d, 0xa5, 0x26, 0xa8, 0x19, 0xa6, 0xfb, 0xbe, 0x7c, 0x64, 0x5e, 0xfc, 0x3f, 0xb0, 0x61, 0x38, 0x42, 0x1b, 0x8d, 0xc3, 0x22, 0x36, 0x21, 0x03, 0x56, 0xf9, 0xdb, 0x04, 0x12, 0x18, 0x73, 0xa5, 0xaa, 0x08, 0x22, 0x26, 0x43, 0xc7, 0x35, 0x51, 0xbe, 0x6a, 0xf1, 0x07, 0xf8, 0x56, 0x07, 0x01, 0x97, 0x46, 0x42, 0x4c, 0x38, 0x16, 0xa1, 0xeb, 0xdf, 0x75, 0xe9, 0xd8, 0x36, 0x79, 0x06, 0x6f, 0x91, 0xee, 0x7b, 0x7f, 0x70, 0xcf, 0xfc, 0xed, 0x14, 0x0d, 0x02, 0xbf, 0xc0, 0x8a, 0xdc, 0x92, 0xa3, 0x43, 0x37, 0xb2, 0xba, 0xe5, 0x1c, 0x0b, 0x2f, 0x57, 0xe4, 0x63, 0x69, 0xf0, 0x3e, 0x29, 0x80, 0x36, 0x26, 0x6f, 0x65, 0x60, 0x7e, 0x1e, 0x00, 0x26, 0xcd, 0x14, 0xfb, 0x86, 0x20, 0x6b, 0xe7, 0x3f, 0xf9, 0xe7, 0xd6, 0xd8, 0xcb, 0x79, 0xf2, 0x54, 0x7d, 0x6b, 0x29, 0x63, 0xc6, 0xc9, 0xf3, 0xe6, 0xcf, 0x8d, 0xcd, 0x05, 0xb2, 0xe1, 0xec, 0xb8, 0xb4, 0x41, 0x3c, 0x8b, 0x03, 0x3a, 0x9c, 0x68, 0x1b, 0xf8, 0x15, 0x1a, 0xda, 0x38, 0x4b, 0x58, 0x3c, 0xce, 0x65, 0x43, 0x9b, 0x79, 0x1a, 0xd1, 0xa3, 0x97, 0x30, 0xb0, 0x7e, 0xb2, 0xd3, 0x8f, 0x10, 0x62, 0xe9, 0xd8, 0xa5, 0x4e, 0x2f, 0xec, 0x8c, 0xc4, 0x03, 0x96, 0xc7, 0x0d, 0x97, 0xb2, 0x3f, 0x07, 0xa3, 0x25, 0x3f, 0x2a, 0xc1, 0x94, 0x0c, 0xd1, 0x8c, 0x31, 0x88, 0x79, 0xd4, 0x3a, 0xb6, 0x3b, 0x42, 0xff, 0xef, 0xc0, 0x9f, 0xc7, 0xbb, 0x61, 0x87, 0x03, 0x44, 0xab, 0x26, 0xad, 0x4a, 0x54, 0x7b, 0x75, 0x69, 0x8f, 0x3c, 0x7f, 0x1c, 0x25, 0x60, 0x58, 0xa8, 0x8c, 0xfb, 0xe3, 0xec, 0x48, 0x90, 0x5f, 0x15, 0x17, 0xcc, 0x0e, 0xe9, 0xc6, 0x8a, 0xa3, 0x41, 0xd0, 0x07, 0xe6, 0x42, 0x01, 0x6d, 0x5b, 0x18, 0x62, 0x0f, 0xb0, 0x05, 0xab, 0x1e, 0xe8, 0x3d, 0x26, 0xa1, 0xe8, 0x7a, 0x31, 0xe2, 0x8b, 0xf5, 0x90, 0xdf, 0xdf, 0x77, 0xee, 0xd4, 0x22, 0x74, 0xaf, 0xbf, 0x22, 0xf3, 0xc5, 0xe3, 0x34, 0x7f, 0x65, 0xb2, 0xaf, 0xf0, 0xc9, 0x24, 0x49, 0x8e, 0x76, 0x90, 0x98, 0xe7, 0x9c, 0xf8, 0x69, 0x86, 0x59, 0xdd, 0xd6, 0x1a, 0x93, 0x94, 0x10, 0x22, 0x18, 0x7c, 0x49, 0x2c, 0x8c, 0xf6, 0x7d, 0xa7, 0x5d, 0x34, 0x5e, 0x06, 0x09, 0x91, 0x48, 0xbe, 0x37, 0x4b, 0x7d, 0x9c, 0x5f, 0x43, 0x0d, 0x4c, 0x08, 0x54, 0x8f, 0x50, 0x3f, 0xad, 0x8c, 0xaa, 0x1b, 0x7e, 0x01, 0xae, 0x10, 0x72, 0xb6, 0x7e, 0xb5, 0xa9, 0x79, 0x01, 0x9c, 0x83, 0xd1, 0xf4, 0xfd, 0x5f, 0xa3, 0xd6, 0x7e, 0xae, 0x2e, 0x67, 0xd7, 0x75, 0x48, 0x04, 0x2f, 0x8a, 0x95, 0x4c, 0x81, 0xa2, 0xdf, 0x8d, 0x7e, 0xc2, 0xbc, 0xf0, 0xc6, 0xb9, 0x6a, 0x54, 0x83, 0xd7, 0x02, 0x5a, 0xb8, 0x82, 0x6a, 0x8d, 0xbf, 0xca, 0x18, 0x8d, 0x8b, 0xf6, 0xaf, 0x9c, 0xbf, 0x66, 0xc5, 0x27, 0x6a, 0xf5, 0x93, 0x7d, 0xdc, 0x17, 0xa5, 0x64, 0x73, 0x8e, 0xe1, 0x2c, 0x1a, 0xaa, 0x10, 0xe6, 0xa7, 0xb1, 0x0c, 0xa6, 0x56, 0x25, 0xea, 0x70, 0xa0, 0xbc, 0x0e, 0xf0, 0x8f, 0xd7, 0x89, 0xc1, 0xaf, 0x13, 0x6c, 0xa2, 0x68, 0xfc, 0xcb, 0x33, 0x5d, 0x66, 0x2d, 0x5b, 0xdc, 0x6a, 0xd3, 0x50, 0x50, 0xb6, 0xcb, 0x01, 0x84, 0x15, 0xb0, 0xe8, 0xde, 0x6e, 0xed, 0x94, 0x8c, 0x9c, 0x84, 0xe2, 0xcf, 0x03, 0x71, 0xaa, 0x9c, 0x77, 0xb1, 0xfa, 0x80, 0x61, 0xf9, 0xe7, 0x72, 0xbb, 0x9c, 0x14, 0xbf, 0xb3, 0x2d, 0xc4, 0x43, 0xf6, 0xcb, 0x91, 0x9c, 0x58, 0x79, 0x0c, 0x95, 0x56, 0xe4, 0x34, 0xf6, 0x6f, 0x01, 0x0a, 0x5d, 0xb4, 0xbe, 0x38, 0x82, 0xda, 0xb3, 0x5b, 0x46, 0xab, 0xc3, 0x40, 0xa5, 0x8e, 0x6b, 0x16, 0xbd, 0x2c, 0x68, 0x55, 0x31, 0xe7, 0x76, 0x77, 0x81, 0x3e, 0x4d, 0x57, 0x42, 0x9a, 0xda, 0xb8, 0xc4, 0x58, 0x77, 0x77, 0x3b, 0x90, 0xba, 0xd4, 0x82, 0xfe, 0x20, 0x0f, 0xc5, 0x60, 0x36, 0x0e, 0x05, 0xad, 0x5e, 0xbe, 0x2a, 0x49, 0x13, 0x5c, 0x44, 0x03, 0x76, 0xca, 0x0f, 0x66, 0xe8, 0x42, 0x15, 0xc1, 0xf3, 0xa7, 0x2f, 0x75, 0x22, 0x9b, 0xf2, 0xa6, 0xf4, 0x11, 0x50, 0x57, 0xe7, 0x19, 0x5d, 0x61, 0x47, 0x06, 0xb9, 0xef, 0x18, 0x20, 0xb5, 0xc3, 0xed, 0x49, 0xcf, 0x8b, 0x40, 0x28, 0x45, 0xc5, 0xc7, 0x91, 0xb8, 0x90, 0xf4, 0x61, 0xfc, 0xda, 0x7d, 0x22, 0xfa, 0x17, 0x61, 0xb4, 0x23, 0xf7, 0x5b, 0x20, 0x4f, 0x0a, 0x0c, 0x56, 0x61, 0x91, 0xfb, 0x92, 0x93, 0x6f, 0xef, 0x80, 0x46, 0x26, 0x69, 0xad, 0x13, 0xbc, 0x81, 0x84, 0xd3, 0x9a, 0x38, 0x87, 0xe4, 0x5d, 0x8b, 0xe5, 0x95, 0x23, 0xf6, 0x79, 0xaa, 0x55, 0xd5, 0x72, 0xfa, 0x80, 0xee, 0x1e, 0x11, 0xcf, 0xbf, 0x03, 0x25, 0x92, 0x0b, 0x07, 0xfb, 0x2f, 0x87, 0xaf, 0xcd, 0x7f, 0xa8, 0x0a, 0x68, 0xcb, 0x35, 0x2d, 0x12, 0xb6, 0x3b, 0x86, 0xad, 0x5c, 0x06, 0x9c, 0x99, 0x18, 0xbd, 0x0e, 0xee, 0x1f, 0x08, 0xf3, 0x91, 0xbb, 0xdd, 0x15, 0x32, 0x05, 0x55, 0x90, 0x65, 0xf8, 0x8a, 0x4c, 0x44, 0xf7, 0x48, 0xda, 0xe1, 0xf9, 0x5b, 0xac, 0x44, 0x89, 0x4b, 0x32, 0xd6, 0x4c, 0x45, 0x50, 0x2a, 0xec, 0xcf, 0xa8, 0xe1, 0x41, 0x9e, 0xf7, 0x6a, 0xc5, 0x77, 0xed, 0x07, 0xb8, 0x48, 0xf0, 0x91, 0x73, 0x22, 0x06, 0x46, 0x70, 0x73, 0x98, 0xdd, 0xb6, 0x2d, 0x09, 0xdf, 0x68, 0xb1, 0xca, 0xdc, 0xda, 0xba, 0xba, 0x38, 0x9e, 0x0f, 0xeb, 0xe6, 0xb0, 0x8c, 0x91, 0x72, 0xc9, 0xab, 0x8a, 0x5f, 0x9e, 0x1e, 0x18, 0xd8, 0xf1, 0x28, 0x36, 0x56, 0x8f, 0x3d, 0x64, 0x9e, 0x24, 0x8d, 0x4f, 0xb5, 0xc0, 0x2a, 0xc7, 0x39, 0xd2, 0xbd, 0x46, 0xc4, 0x82, 0xe5, 0xfa, 0x18, 0x03, 0xbf, 0xac, 0xa7, 0xd2, 0x97, 0x33, 0x76, 0xdc, 0xbc, 0x12, 0x40, 0x14, 0x08, 0x2c, 0x88, 0x11, 0x25, 0x1f, 0x0d, 0xfb, 0x4c, 0x5b, 0x70, 0x7a, 0xee, 0x90, 0x97, 0xc8, 0x5c, 0xce, 0x27, 0x5b, 0x7f, 0x2c, 0xf0, 0xe7, 0xe7, 0x71, 0xd1, 0x46, 0x25, 0xb4, 0xd9, 0xf1, 0x04, 0xb8, 0x42, 0x09, 0x75, 0xad, 0xf9, 0x7a, 0x79, 0xee, 0x13, 0x35, 0x63, 0x5e, 0x1c, 0x98, 0x6b, 0xe6, 0x7f, 0xaa, 0xe5, 0x6f, 0x3d, 0x74, 0x2b, 0xac, 0x6d, 0x52, 0xb8, 0x9a, 0x26, 0x43, 0x1a, 0xe4, 0xce, 0xbf, 0xf0, 0x12, 0xd5, 0x55, 0xc2, 0xaf, 0xb4, 0x9a, 0x40, 0xb1, 0x4c, 0x03, 0xfb, 0x1d, 0x0d, 0xb4, 0xf2, 0x14, 0x6e, 0x7f, 0x6b, 0xd3, 0x99, 0x10, 0x28, 0xfb, 0x8c, 0x57, 0x01, 0xff, 0x99, 0x6b, 0x6e, 0x62, 0xfc, 0x2f, 0x3a, 0x22, 0xed, 0x0f, 0x2f, 0x43, 0xaf, 0x4b, 0x55, 0xf5, 0x0d, 0x8f, 0x0c, 0x46, 0x2a, 0x8e, 0x70, 0x88, 0x23, 0x11, 0x81, 0x89, 0xa7, 0x2d, 0x0e, 0x15, 0xa6, 0xc4, 0x26, 0xe9, 0xdb, 0xec, 0x15, 0x8f, 0x40, 0xa2, 0x8d, 0x8c, 0x92, 0x7f, 0x45, 0x34, 0x29, 0x33, 0x15, 0xff, 0xfe, 0xdb, 0xbb, 0xd4, 0x30, 0x41, 0xa7, 0x11, 0xaa, 0xd7, 0xb4, 0x4d, 0x23, 0xba, 0xe3, 0x7f, 0x3a, 0x80, 0xdf, 0xc9, 0x22, 0xfa, 0xc7, 0xbf, 0xdd, 0x50, 0x53, 0x33, 0x41, 0xed, 0x5e, 0x4c, 0x3c, 0x74, 0x8c, 0x28, 0x56, 0x48, 0xa3, 0xdb, 0x11, 0x71, 0xd0, 0x01, 0x15, 0xfb, 0x26, 0x3c, 0x2a, 0x73, 0x45, 0x05, 0xfd, 0xec, 0xc6, 0x40, 0xe5, 0x72, 0x4f, 0xc4, 0x36, 0x3e, 0x74, 0x92, 0x0c, 0x33, 0x0a, 0x33, 0x6f, 0x54, 0xbc, 0x89, 0x2b, 0xe6, 0x66, 0x8f, 0xd0, 0x4d, 0x1e, 0x47, 0x09, 0xcf, 0xa9, 0xac, 0xc0, 0x8e, 0xd4, 0x71, 0xe1, 0xc1, 0x88, 0xbb, 0x09, 0x58, 0xcb, 0xbc, 0x9c, 0x70, 0x48, 0xc9, 0xe6, 0xcb, 0x73, 0x8e, 0x1e, 0x03, 0x69, 0x66, 0x23, 0x4e, 0xf3, 0x22, 0x97, 0x78, 0x42, 0xd7, 0x46, 0xca, 0xba, 0x86, 0xcc, 0x24, 0x4d, 0xb0, 0x41, 0xac, 0x48, 0xc2, 0x24, 0x81, 0x40, 0x36, 0x35, 0xc4, 0x8f, 0x55, 0xc2, 0x10, 0xa6, 0x30, 0x69, 0x7e, 0xc8, 0xec, 0x66, 0xb2, 0xa5, 0xf9, 0x44, 0xa3, 0x4c, 0x7d, 0xf1, 0xd0, 0x72, 0x67, 0x58, 0xe1, 0x14, 0xe6, 0xdd, 0xd8, 0xd5, 0x40, 0x6d, 0x08, 0xfe, 0xa3, 0x03, 0x87, 0x30, 0xc1, 0x11, 0xbb, 0x2f, 0x04,
}

var shieldedTx = &MsgTx{
	Version: 2,
	TxIn: []*TxIn{
		{
			PreviousOutPoint: OutPoint{
				Hash:  chainhash.Hash{},
				Index: 0,
			},
			SignatureScript: []byte{0x47, 0x30, 0x44, 0x02, 0x20, 0x11, 0x95, 0x12, 0x3c, 0x9a, 0xb5, 0xb7, 0xeb, 0xb0, 0x14, 0x11, 0xd5, 0x88, 0x37, 0xcf, 0x29, 0xa2, 0x7c, 0x6b, 0xaf, 0x2a, 0x8d, 0x50, 0x61, 0x63, 0x87, 0xaa, 0x5d, 0xae, 0x43, 0x50, 0x37, 0x02, 0x20, 0x60, 0xff, 0xa7, 0x5a, 0x73, 0x2f, 0x6f, 0x6d, 0x53, 0x74, 0x6b, 0x3a, 0x03, 0xa2, 0x90, 0x12, 0x12, 0x90, 0x7c, 0x8c, 0xd3, 0x3b, 0x29, 0x93, 0x8e, 0x2d, 0xed, 0xa4, 0xaa, 0xa4, 0x87, 0xb7, 0x01, 0x21, 0x03, 0xf8, 0x92, 0xec, 0x10, 0x6c, 0x94, 0xbd, 0xea, 0xd9, 0xf0, 0x88, 0x79, 0x7e, 0xc2, 0xbb, 0x6d, 0x0f, 0x46, 0xcc, 0x7f, 0x7e, 0x6a, 0x93, 0x1a, 0x0f, 0xd7, 0x6c, 0x52, 0xae, 0xe5, 0xd0, 0x16},
			Sequence:        4294967295,
		},
	},
	TxOut:    []*TxOut{},
	LockTime: 0,
	TxJoinsplit: []*Joinsplit{
		{
			Vpub_old: 1143740000,
			Vpub_new: 0,
			Anchor:   []byte{0xea, 0xd8, 0x3f, 0x30, 0x4d, 0x40, 0xf2, 0x5e, 0xda, 0xca, 0x59, 0x3c, 0x72, 0x56, 0x52, 0x22, 0x88, 0xd1, 0xa1, 0xe8, 0x21, 0xf4, 0x04, 0x37, 0x62, 0xca, 0x33, 0x09, 0xca, 0x86, 0x18, 0x6c},
			Nullifiers: [][]byte{
				[]byte{0xb8, 0x22, 0x6b, 0x89, 0xdc, 0xf8, 0x07, 0x9e, 0xc7, 0x58, 0x5c, 0x12, 0x1f, 0xa3, 0x4f, 0x3b, 0x73, 0x84, 0xd6, 0xfa, 0x03, 0x51, 0x36, 0x41, 0x4e, 0x58, 0x6b, 0xa3, 0xc1, 0x40, 0x2f, 0x0e},
				[]byte{0xcd, 0xe4, 0xf5, 0x35, 0xb6, 0x1a, 0x20, 0xe3, 0x18, 0xf1, 0xa8, 0x0a, 0x43, 0x6d, 0x64, 0x33, 0x29, 0x91, 0x8b, 0x90, 0x7f, 0xbe, 0x9d, 0x73, 0xfe, 0x31, 0x40, 0xc5, 0xb1, 0xe0, 0x38, 0xb9},
			},
			Commitments: [][]byte{
				[]byte{0x23, 0x19, 0x5d, 0xcb, 0xdf, 0x48, 0x91, 0x5c, 0x5f, 0x2d, 0x55, 0x9a, 0x81, 0x54, 0xf1, 0x5b, 0x39, 0x6d, 0x96, 0xdb, 0xf5, 0x35, 0xc7, 0x2a, 0x26, 0x3a, 0x1d, 0xda, 0x28, 0x90, 0x13, 0xbd},
				[]byte{0x6d, 0x7f, 0x54, 0x04, 0xca, 0xf7, 0x8e, 0x15, 0x3c, 0x04, 0x27, 0xf0, 0xc7, 0x76, 0xfd, 0x86, 0xbf, 0xac, 0xeb, 0x8a, 0x5f, 0x86, 0x0c, 0x4d, 0x5e, 0xda, 0x33, 0x5c, 0x6d, 0xdf, 0xc0, 0xbc},
			},
			OneTimePubKey: []byte{0x58, 0xba, 0x26, 0xf9, 0x31, 0xa9, 0xf7, 0xe4, 0xdb, 0x19, 0x81, 0x02, 0xe5, 0x72, 0x8b, 0x79, 0x2b, 0x3c, 0x84, 0x63, 0x8b, 0x70, 0x80, 0x4a, 0x61, 0x78, 0x1a, 0x63, 0xb3, 0xa9, 0x01, 0xd3},
			RandomSeed:    []byte{0xa0, 0x90, 0xa8, 0x64, 0x4b, 0x7a, 0xad, 0x47, 0x46, 0x87, 0xbf, 0x8f, 0x32, 0xfa, 0xae, 0xb2, 0x3a, 0x4b, 0xfa, 0x63, 0xdc, 0xbd, 0x60, 0x15, 0xe7, 0x8a, 0xb7, 0x03, 0xb0, 0xe8, 0xab, 0x57},
			Macs: [][]byte{
				[]byte{0x51, 0xe4, 0x0a, 0xc1, 0x48, 0x1a, 0x08, 0x2b, 0x77, 0x84, 0x59, 0xab, 0x3f, 0xce, 0xf9, 0xd1, 0xc6, 0x70, 0x69, 0xac, 0xb3, 0x5e, 0xd1, 0xca, 0x40, 0x7a, 0x5b, 0x02, 0x05, 0x1a, 0xf3, 0x5c},
				[]byte{0x17, 0xdf, 0x78, 0xc1, 0xe6, 0x20, 0xee, 0x5f, 0x07, 0xe2, 0x2a, 0x6a, 0xba, 0x7b, 0x9d, 0x6a, 0x29, 0xa7, 0xd2, 0x05, 0x61, 0xa6, 0x7e, 0xe2, 0x8b, 0xce, 0x7d, 0x08, 0x1a, 0x10, 0x6c, 0xbe},
			},
			Proof: []byte{0x02, 0x27, 0x8a, 0xa7, 0xb8, 0x6d, 0x41, 0x09, 0xac, 0xda, 0x64, 0x01, 0x65, 0x48, 0xfc, 0x23, 0x8d, 0x60, 0x52, 0x52, 0x30, 0x29, 0xc2, 0x85, 0xc1, 0x7e, 0x0c, 0xc4, 0x7b, 0xb1, 0x06, 0x49, 0xaa, 0x03, 0x02, 0x45, 0x79, 0x33, 0xdd, 0xea, 0x07, 0x92, 0xa1, 0xee, 0x27, 0x92, 0x0d, 0xda, 0xfb, 0x8a, 0x59, 0xe6, 0x54, 0x00, 0xd7, 0xef, 0x2b, 0x38, 0xad, 0x9a, 0x2d, 0x29, 0x2b, 0xc7, 0xb8, 0xca, 0x0b, 0x01, 0xbb, 0x79, 0xb2, 0x56, 0x46, 0xa5, 0x43, 0x69, 0xfd, 0x76, 0xa0, 0x3a, 0xc1, 0x8c, 0x9a, 0xbd, 0x42, 0xa6, 0x2c, 0xf4, 0xe2, 0x19, 0x8b, 0x9a, 0x7e, 0xab, 0xbe, 0x33, 0xa7, 0x3d, 0xc7, 0x4b, 0x0c, 0x0c, 0x3b, 0x24, 0x39, 0x5b, 0x72, 0xd2, 0x80, 0xdd, 0x08, 0x5e, 0xd8, 0x5c, 0x09, 0xa1, 0xe1, 0x01, 0x67, 0x93, 0x15, 0x36, 0xe0, 0x7b, 0x3a, 0x3c, 0xe6, 0xe1, 0x40, 0x00, 0xc6, 0x02, 0x2b, 0x03, 0xf9, 0x19, 0xee, 0xf0, 0x22, 0xdd, 0xe2, 0x9b, 0xf3, 0x3c, 0x82, 0x21, 0x78, 0x24, 0xd4, 0xfb, 0xfa, 0x01, 0x1c, 0x9d, 0xc4, 0xe7, 0x0c, 0x5a, 0xe9, 0x5a, 0xce, 0x32, 0x00, 0xd6, 0x02, 0x05, 0x0f, 0x8c, 0x46, 0x3e, 0x16, 0xa9, 0x45, 0x33, 0x6d, 0x4b, 0x82, 0xac, 0x44, 0x1b, 0x27, 0xe1, 0x69, 0x8c, 0x75, 0xb3, 0x96, 0x17, 0xa4, 0x2e, 0xb6, 0xad, 0xf1, 0x77, 0xfa, 0x6a, 0x63, 0x02, 0x1b, 0x8e, 0x15, 0x76, 0xfa, 0x2e, 0x7f, 0xc9, 0xa5, 0x50, 0x1b, 0x45, 0x3b, 0xde, 0x19, 0xaa, 0x53, 0xac, 0x40, 0xd7, 0xb5, 0x3f, 0x1a, 0xa7, 0xa4, 0x45, 0xaa, 0x06, 0x83, 0xce, 0xc1, 0xd5, 0x02, 0x2e, 0x03, 0x16, 0x4b, 0xcc, 0x99, 0x20, 0x12, 0x17, 0xb9, 0x42, 0x8b, 0xe3, 0x26, 0x36, 0x8b, 0x21, 0x07, 0xf8, 0x7e, 0xcd, 0xa2, 0x5f, 0xec, 0xab, 0x34, 0xfc, 0x7e, 0x4a, 0xce, 0x6e, 0xd7, 0x02, 0x10, 0xbd, 0xcc, 0xe9, 0x22, 0x54, 0x87, 0x9c, 0x34, 0x99, 0x7b, 0x01, 0x20, 0xf2, 0xb0, 0x20, 0xf5, 0xdd, 0x9d, 0x70, 0x25, 0x4e, 0xf1, 0x03, 0x7f, 0xd3, 0x02, 0x85, 0x26, 0x08, 0xf1, 0x43},
			CipherText: [][]byte{
				[]byte{0x28, 0xf5, 0x43, 0x08, 0x63, 0x89, 0x89, 0x5c, 0x22, 0x96, 0x5d, 0x69, 0x7a, 0xf3, 0xe7, 0x2c, 0x58, 0x1b, 0x47, 0x1e, 0xed, 0x75, 0x4a, 0xc8, 0xd1, 0x5c, 0xfd, 0xa2, 0xdf, 0x8f, 0xb2, 0x98, 0x45, 0x1c, 0x1d, 0xe2, 0xf2, 0xf4, 0x99, 0xc6, 0x4a, 0xe4, 0xae, 0x70, 0x0f, 0xe4, 0x56, 0x57, 0x1e, 0xc5, 0xbc, 0x7b, 0x4b, 0x8b, 0xba, 0x19, 0x09, 0xd3, 0xe9, 0xfb, 0x17, 0x83, 0xec, 0x48, 0x67, 0xbb, 0x72, 0x36, 0x58, 0x4b, 0x6c, 0x86, 0xea, 0xd4, 0xcb, 0xb0, 0xc3, 0xaa, 0x22, 0xb2, 0xcf, 0xf9, 0x9a, 0xc7, 0x5c, 0x42, 0x2e, 0xf8, 0xf2, 0x14, 0x4e, 0x5b, 0x72, 0x32, 0x0b, 0x4c, 0x51, 0x41, 0x0b, 0x05, 0xea, 0xd6, 0x48, 0x22, 0x12, 0x42, 0xd3, 0xdf, 0xfc, 0x5c, 0xa5, 0xf9, 0x15, 0x58, 0x47, 0x14, 0x32, 0xf4, 0xeb, 0xbc, 0x28, 0x88, 0xe5, 0xd4, 0xc8, 0x1b, 0xae, 0x0f, 0x3e, 0x07, 0xd3, 0x71, 0xae, 0x56, 0x05, 0xd6, 0xbd, 0x19, 0x3a, 0x72, 0xfc, 0x91, 0x92, 0x52, 0x57, 0x51, 0x78, 0xd4, 0x1b, 0x48, 0xcb, 0x87, 0xad, 0xbf, 0xe6, 0x3d, 0xa5, 0x26, 0xa8, 0x19, 0xa6, 0xfb, 0xbe, 0x7c, 0x64, 0x5e, 0xfc, 0x3f, 0xb0, 0x61, 0x38, 0x42, 0x1b, 0x8d, 0xc3, 0x22, 0x36, 0x21, 0x03, 0x56, 0xf9, 0xdb, 0x04, 0x12, 0x18, 0x73, 0xa5, 0xaa, 0x08, 0x22, 0x26, 0x43, 0xc7, 0x35, 0x51, 0xbe, 0x6a, 0xf1, 0x07, 0xf8, 0x56, 0x07, 0x01, 0x97, 0x46, 0x42, 0x4c, 0x38, 0x16, 0xa1, 0xeb, 0xdf, 0x75, 0xe9, 0xd8, 0x36, 0x79, 0x06, 0x6f, 0x91, 0xee, 0x7b, 0x7f, 0x70, 0xcf, 0xfc, 0xed, 0x14, 0x0d, 0x02, 0xbf, 0xc0, 0x8a, 0xdc, 0x92, 0xa3, 0x43, 0x37, 0xb2, 0xba, 0xe5, 0x1c, 0x0b, 0x2f, 0x57, 0xe4, 0x63, 0x69, 0xf0, 0x3e, 0x29, 0x80, 0x36, 0x26, 0x6f, 0x65, 0x60, 0x7e, 0x1e, 0x00, 0x26, 0xcd, 0x14, 0xfb, 0x86, 0x20, 0x6b, 0xe7, 0x3f, 0xf9, 0xe7, 0xd6, 0xd8, 0xcb, 0x79, 0xf2, 0x54, 0x7d, 0x6b, 0x29, 0x63, 0xc6, 0xc9, 0xf3, 0xe6, 0xcf, 0x8d, 0xcd, 0x05, 0xb2, 0xe1, 0xec, 0xb8, 0xb4, 0x41, 0x3c, 0x8b, 0x03, 0x3a, 0x9c, 0x68, 0x1b, 0xf8, 0x15, 0x1a, 0xda, 0x38, 0x4b, 0x58, 0x3c, 0xce, 0x65, 0x43, 0x9b, 0x79, 0x1a, 0xd1, 0xa3, 0x97, 0x30, 0xb0, 0x7e, 0xb2, 0xd3, 0x8f, 0x10, 0x62, 0xe9, 0xd8, 0xa5, 0x4e, 0x2f, 0xec, 0x8c, 0xc4, 0x03, 0x96, 0xc7, 0x0d, 0x97, 0xb2, 0x3f, 0x07, 0xa3, 0x25, 0x3f, 0x2a, 0xc1, 0x94, 0x0c, 0xd1, 0x8c, 0x31, 0x88, 0x79, 0xd4, 0x3a, 0xb6, 0x3b, 0x42, 0xff, 0xef, 0xc0, 0x9f, 0xc7, 0xbb, 0x61, 0x87, 0x03, 0x44, 0xab, 0x26, 0xad, 0x4a, 0x54, 0x7b, 0x75, 0x69, 0x8f, 0x3c, 0x7f, 0x1c, 0x25, 0x60, 0x58, 0xa8, 0x8c, 0xfb, 0xe3, 0xec, 0x48, 0x90, 0x5f, 0x15, 0x17, 0xcc, 0x0e, 0xe9, 0xc6, 0x8a, 0xa3, 0x41, 0xd0, 0x07, 0xe6, 0x42, 0x01, 0x6d, 0x5b, 0x18, 0x62, 0x0f, 0xb0, 0x05, 0xab, 0x1e, 0xe8, 0x3d, 0x26, 0xa1, 0xe8, 0x7a, 0x31, 0xe2, 0x8b, 0xf5, 0x90, 0xdf, 0xdf, 0x77, 0xee, 0xd4, 0x22, 0x74, 0xaf, 0xbf, 0x22, 0xf3, 0xc5, 0xe3, 0x34, 0x7f, 0x65, 0xb2, 0xaf, 0xf0, 0xc9, 0x24, 0x49, 0x8e, 0x76, 0x90, 0x98, 0xe7, 0x9c, 0xf8, 0x69, 0x86, 0x59, 0xdd, 0xd6, 0x1a, 0x93, 0x94, 0x10, 0x22, 0x18, 0x7c, 0x49, 0x2c, 0x8c, 0xf6, 0x7d, 0xa7, 0x5d, 0x34, 0x5e, 0x06, 0x09, 0x91, 0x48, 0xbe, 0x37, 0x4b, 0x7d, 0x9c, 0x5f, 0x43, 0x0d, 0x4c, 0x08, 0x54, 0x8f, 0x50, 0x3f, 0xad, 0x8c, 0xaa, 0x1b, 0x7e, 0x01, 0xae, 0x10, 0x72, 0xb6, 0x7e, 0xb5, 0xa9, 0x79, 0x01, 0x9c, 0x83, 0xd1, 0xf4, 0xfd, 0x5f, 0xa3, 0xd6, 0x7e, 0xae, 0x2e, 0x67, 0xd7, 0x75, 0x48, 0x04, 0x2f, 0x8a, 0x95, 0x4c, 0x81, 0xa2, 0xdf, 0x8d, 0x7e, 0xc2, 0xbc, 0xf0, 0xc6, 0xb9, 0x6a, 0x54, 0x83, 0xd7, 0x02, 0x5a, 0xb8, 0x82, 0x6a, 0x8d, 0xbf, 0xca, 0x18, 0x8d, 0x8b, 0xf6, 0xaf, 0x9c, 0xbf, 0x66, 0xc5, 0x27, 0x6a, 0xf5, 0x93, 0x7d, 0xdc, 0x17, 0xa5, 0x64, 0x73, 0x8e, 0xe1, 0x2c, 0x1a, 0xaa, 0x10, 0xe6, 0xa7, 0xb1, 0x0c, 0xa6, 0x56, 0x25, 0xea, 0x70, 0xa0, 0xbc, 0x0e, 0xf0, 0x8f, 0xd7, 0x89, 0xc1, 0xaf, 0x13, 0x6c, 0xa2, 0x68, 0xfc, 0xcb},
				[]byte{0x33, 0x5d, 0x66, 0x2d, 0x5b, 0xdc, 0x6a, 0xd3, 0x50, 0x50, 0xb6, 0xcb, 0x01, 0x84, 0x15, 0xb0, 0xe8, 0xde, 0x6e, 0xed, 0x94, 0x8c, 0x9c, 0x84, 0xe2, 0xcf, 0x03, 0x71, 0xaa, 0x9c, 0x77, 0xb1, 0xfa, 0x80, 0x61, 0xf9, 0xe7, 0x72, 0xbb, 0x9c, 0x14, 0xbf, 0xb3, 0x2d, 0xc4, 0x43, 0xf6, 0xcb, 0x91, 0x9c, 0x58, 0x79, 0x0c, 0x95, 0x56, 0xe4, 0x34, 0xf6, 0x6f, 0x01, 0x0a, 0x5d, 0xb4, 0xbe, 0x38, 0x82, 0xda, 0xb3, 0x5b, 0x46, 0xab, 0xc3, 0x40, 0xa5, 0x8e, 0x6b, 0x16, 0xbd, 0x2c, 0x68, 0x55, 0x31, 0xe7, 0x76, 0x77, 0x81, 0x3e, 0x4d, 0x57, 0x42, 0x9a, 0xda, 0xb8, 0xc4, 0x58, 0x77, 0x77, 0x3b, 0x90, 0xba, 0xd4, 0x82, 0xfe, 0x20, 0x0f, 0xc5, 0x60, 0x36, 0x0e, 0x05, 0xad, 0x5e, 0xbe, 0x2a, 0x49, 0x13, 0x5c, 0x44, 0x03, 0x76, 0xca, 0x0f, 0x66, 0xe8, 0x42, 0x15, 0xc1, 0xf3, 0xa7, 0x2f, 0x75, 0x22, 0x9b, 0xf2, 0xa6, 0xf4, 0x11, 0x50, 0x57, 0xe7, 0x19, 0x5d, 0x61, 0x47, 0x06, 0xb9, 0xef, 0x18, 0x20, 0xb5, 0xc3, 0xed, 0x49, 0xcf, 0x8b, 0x40, 0x28, 0x45, 0xc5, 0xc7, 0x91, 0xb8, 0x90, 0xf4, 0x61, 0xfc, 0xda, 0x7d, 0x22, 0xfa, 0x17, 0x61, 0xb4, 0x23, 0xf7, 0x5b, 0x20, 0x4f, 0x0a, 0x0c, 0x56, 0x61, 0x91, 0xfb, 0x92, 0x93, 0x6f, 0xef, 0x80, 0x46, 0x26, 0x69, 0xad, 0x13, 0xbc, 0x81, 0x84, 0xd3, 0x9a, 0x38, 0x87, 0xe4, 0x5d, 0x8b, 0xe5, 0x95, 0x23, 0xf6, 0x79, 0xaa, 0x55, 0xd5, 0x72, 0xfa, 0x80, 0xee, 0x1e, 0x11, 0xcf, 0xbf, 0x03, 0x25, 0x92, 0x0b, 0x07, 0xfb, 0x2f, 0x87, 0xaf, 0xcd, 0x7f, 0xa8, 0x0a, 0x68, 0xcb, 0x35, 0x2d, 0x12, 0xb6, 0x3b, 0x86, 0xad, 0x5c, 0x06, 0x9c, 0x99, 0x18, 0xbd, 0x0e, 0xee, 0x1f, 0x08, 0xf3, 0x91, 0xbb, 0xdd, 0x15, 0x32, 0x05, 0x55, 0x90, 0x65, 0xf8, 0x8a, 0x4c, 0x44, 0xf7, 0x48, 0xda, 0xe1, 0xf9, 0x5b, 0xac, 0x44, 0x89, 0x4b, 0x32, 0xd6, 0x4c, 0x45, 0x50, 0x2a, 0xec, 0xcf, 0xa8, 0xe1, 0x41, 0x9e, 0xf7, 0x6a, 0xc5, 0x77, 0xed, 0x07, 0xb8, 0x48, 0xf0, 0x91, 0x73, 0x22, 0x06, 0x46, 0x70, 0x73, 0x98, 0xdd, 0xb6, 0x2d, 0x09, 0xdf, 0x68, 0xb1, 0xca, 0xdc, 0xda, 0xba, 0xba, 0x38, 0x9e, 0x0f, 0xeb, 0xe6, 0xb0, 0x8c, 0x91, 0x72, 0xc9, 0xab, 0x8a, 0x5f, 0x9e, 0x1e, 0x18, 0xd8, 0xf1, 0x28, 0x36, 0x56, 0x8f, 0x3d, 0x64, 0x9e, 0x24, 0x8d, 0x4f, 0xb5, 0xc0, 0x2a, 0xc7, 0x39, 0xd2, 0xbd, 0x46, 0xc4, 0x82, 0xe5, 0xfa, 0x18, 0x03, 0xbf, 0xac, 0xa7, 0xd2, 0x97, 0x33, 0x76, 0xdc, 0xbc, 0x12, 0x40, 0x14, 0x08, 0x2c, 0x88, 0x11, 0x25, 0x1f, 0x0d, 0xfb, 0x4c, 0x5b, 0x70, 0x7a, 0xee, 0x90, 0x97, 0xc8, 0x5c, 0xce, 0x27, 0x5b, 0x7f, 0x2c, 0xf0, 0xe7, 0xe7, 0x71, 0xd1, 0x46, 0x25, 0xb4, 0xd9, 0xf1, 0x04, 0xb8, 0x42, 0x09, 0x75, 0xad, 0xf9, 0x7a, 0x79, 0xee, 0x13, 0x35, 0x63, 0x5e, 0x1c, 0x98, 0x6b, 0xe6, 0x7f, 0xaa, 0xe5, 0x6f, 0x3d, 0x74, 0x2b, 0xac, 0x6d, 0x52, 0xb8, 0x9a, 0x26, 0x43, 0x1a, 0xe4, 0xce, 0xbf, 0xf0, 0x12, 0xd5, 0x55, 0xc2, 0xaf, 0xb4, 0x9a, 0x40, 0xb1, 0x4c, 0x03, 0xfb, 0x1d, 0x0d, 0xb4, 0xf2, 0x14, 0x6e, 0x7f, 0x6b, 0xd3, 0x99, 0x10, 0x28, 0xfb, 0x8c, 0x57, 0x01, 0xff, 0x99, 0x6b, 0x6e, 0x62, 0xfc, 0x2f, 0x3a, 0x22, 0xed, 0x0f, 0x2f, 0x43, 0xaf, 0x4b, 0x55, 0xf5, 0x0d, 0x8f, 0x0c, 0x46, 0x2a, 0x8e, 0x70, 0x88, 0x23, 0x11, 0x81, 0x89, 0xa7, 0x2d, 0x0e, 0x15, 0xa6, 0xc4, 0x26, 0xe9, 0xdb, 0xec, 0x15, 0x8f, 0x40, 0xa2, 0x8d, 0x8c, 0x92, 0x7f, 0x45, 0x34, 0x29, 0x33, 0x15, 0xff, 0xfe, 0xdb, 0xbb, 0xd4, 0x30, 0x41, 0xa7, 0x11, 0xaa, 0xd7, 0xb4, 0x4d, 0x23, 0xba, 0xe3, 0x7f, 0x3a, 0x80, 0xdf, 0xc9, 0x22, 0xfa, 0xc7, 0xbf, 0xdd, 0x50, 0x53, 0x33, 0x41, 0xed, 0x5e, 0x4c, 0x3c, 0x74, 0x8c, 0x28, 0x56, 0x48, 0xa3, 0xdb, 0x11, 0x71, 0xd0, 0x01, 0x15, 0xfb, 0x26, 0x3c, 0x2a, 0x73, 0x45, 0x05, 0xfd, 0xec, 0xc6, 0x40, 0xe5, 0x72, 0x4f, 0xc4, 0x36, 0x3e, 0x74, 0x92, 0x0c, 0x33, 0x0a, 0x33, 0x6f, 0x54, 0xbc, 0x89, 0x2b, 0xe6, 0x66, 0x8f, 0xd0, 0x4d, 0x1e, 0x47},
			},
			joinSplitPubKey: []byte{0x09, 0xcf, 0xa9, 0xac, 0xc0, 0x8e, 0xd4, 0x71, 0xe1, 0xc1, 0x88, 0xbb, 0x09, 0x58, 0xcb, 0xbc, 0x9c, 0x70, 0x48, 0xc9, 0xe6, 0xcb, 0x73, 0x8e, 0x1e, 0x03, 0x69, 0x66, 0x23, 0x4e, 0xf3, 0x22},
			joinSplitSig:    []byte{0x97, 0x78, 0x42, 0xd7, 0x46, 0xca, 0xba, 0x86, 0xcc, 0x24, 0x4d, 0xb0, 0x41, 0xac, 0x48, 0xc2, 0x24, 0x81, 0x40, 0x36, 0x35, 0xc4, 0x8f, 0x55, 0xc2, 0x10, 0xa6, 0x30, 0x69, 0x7e, 0xc8, 0xec, 0x66, 0xb2, 0xa5, 0xf9, 0x44, 0xa3, 0x4c, 0x7d, 0xf1, 0xd0, 0x72, 0x67, 0x58, 0xe1, 0x14, 0xe6, 0xdd, 0xd8, 0xd5, 0x40, 0x6d, 0x08, 0xfe, 0xa3, 0x03, 0x87, 0x30, 0xc1, 0x11, 0xbb, 0x2f, 0x04},
		},
	},
}
